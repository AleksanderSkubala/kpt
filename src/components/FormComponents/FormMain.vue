<template>
<div>
      <table class="ui celled striped center aligned table" id="mainTable">
        <thead>
            <tr>
                <th colspan="2">
                    Konspekt
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td> <!--style="width: 50%;"-->
                    Nazwa zbiórki:
                </td>
                <td>
                    <div v-if="title.edit === false">
                        {{title.content}}
                        <div class="ui right floated button editBtn" @click="edit(0)">
                            <i class="ui edit outline icon editIcon"></i>
                        </div>
                    </div>
                    <div class="ui action input" v-if="title.edit">
                        <input placeholder="Nazwa/Temat zbiórki" type="text" v-model="title.probably"/>
                        <div class="ui positive button" @click="check(0)">
                            <i class="check icon" style="margin:0;"></i>
                        </div>
                        <div class="ui negative button" @click="cancel(0)">
                            <i class="plus icon cancelIcon"></i>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Odpowiedzialny/a:
                </td>
                <td>
                    <div v-if="main.edit === false">
                        {{main.content}}
                        <div class="ui right floated button editBtn" @click="edit(1)">
                            <i class="ui edit outline icon editIcon"></i>
                        </div>
                    </div>
                    <div class="ui action input" v-if="main.edit">
                        <input placeholder="Odpowiedzialny" type="text" v-model="main.probably"/>
                        <div class="ui positive button" @click="check(1)">
                            <i class="check icon" style="margin:0;"></i>
                        </div>
                        <div class="ui negative button" @click="cancel(1)">
                            <i class="plus icon cancelIcon"></i>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Termin:
                </td>
                <td>
                    <div v-if="when.edit === false">
                        {{when.content}}
                        <div class="ui right floated button editBtn" @click="edit(2)">
                            <i class="ui edit outline icon editIcon"></i>
                        </div>
                    </div>
                    <div class="ui action input" v-if="when.edit">
                        <input type="date" v-model="when.probably"/>
                        <div class="ui positive button" @click="check(2)">
                            <i class="check icon" style="margin:0;"></i>
                        </div>
                        <div class="ui negative button" @click="cancel(2)">
                            <i class="plus icon cancelIcon"></i>
                        </div>
                    </div>
                </td>
            </tr>
            <tr style="background: none;">
                <td colspan="2">
                   <table class="ui striped table">
                        <thead>
                            <tr>
                                <th colspan="2">Prowadzący:</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 50%;">
                                    <ul class="ui divided list segments" style="margin: 0;">
                                        <li class="ui segment" style="padding: 10px;"><em>Prowadzący: </em></li>
                                        <li v-for="item in people.list" class="ui segment" style="padding: 10px;">
                                            <div v-if="item.edit === false">
                                                <div class="itemName">{{item.name}}</div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="deleteList(0, item)">
                                                    <i class="ui cancel outline icon editIcon"></i>
                                                </div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="editList(0, item)">
                                                    <i class="ui edit outline icon editIcon"></i>
                                                </div>
                                            </div>
                                            <div class="ui action add input" style="margin-top: 5px;" v-if="item.edit">
                                                <input type="text" v-model="item.editContent"/>
                                                <div class="ui positive button" @click="confirm(0, item)">
                                                    <i class="check icon" style="margin: 0;"></i>
                                                </div>
                                                <div class="ui negative button" @click="item.edit = false">
                                                    <i class="plus icon cancelIcon"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </td>
                                <td style="width: 50%;">
                                    <div class="ui action add input">
                                        <input type="text" v-model="people.probably" placeholder="Prowadzący"/>
                                        <div class="ui yellow button" @click="add(0)">
                                            <i class="plus icon" style="margin: 0;"></i>
                                        </div>
                                        <div class="ui negative button" @click="cancelList(0)">
                                            <i class="plus icon cancelIcon"></i>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <table class="ui striped table">
                        <thead>
                            <tr>
                                <th colspan="2">Cele:</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 50%;">
                                    <ul class="ui divided list segments" style="margin: 0;">
                                        <li class="ui segment" style="padding: 10px;"><em>Harcerz po zbiórce będzie umiał: </em></li>
                                        <li v-for="item in goals.list" class="ui segment" style="padding: 10px;">
                                            <div v-if="item.edit === false">
                                                <div class="itemName">{{item.name}}</div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="deleteList(1, item)">
                                                    <i class="ui cancel outline icon editIcon"></i>
                                                </div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="editList(1, item)">
                                                    <i class="ui edit outline icon editIcon"></i>
                                                </div>
                                            </div>
                                            <div class="ui action add input" style="margin-top: 5px;" v-if="item.edit">
                                                <input type="text" v-model="item.editContent"/>
                                                <div class="ui positive button" @click="confirm(1, item)">
                                                    <i class="check icon" style="margin: 0;"></i>
                                                </div>
                                                <div class="ui negative button" @click="item.edit = false">
                                                    <i class="plus icon cancelIcon"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </td>
                                <td style="width: 50%;">
                                    <div class="ui action add input">
                                        <input type="text" v-model="goals.probably" placeholder="Cele"/>
                                        <div class="ui yellow button" @click="add(1)">
                                            <i class="plus icon" style="margin: 0;"></i>
                                        </div>
                                        <div class="ui negative button" @click="cancelList(1)">
                                            <i class="plus icon cancelIcon"></i>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr style="background: none;">
                <td colspan="2">
                   <table class="ui striped table">
                        <thead>
                            <tr>
                                <th colspan="5">Przebieg:</th>
                            </tr>
                            <tr>
                                <th>Lp.</th>
                                <th>Treść</th>
                                <th>Czas</th>
                                <th>Materiały</th>
                                <th>Edycja</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1.</td>
                                <td>Jaki pkt</td>
                                <td class="time">30min.</td>
                                <td>-</td>
                                <td>
                                    <div style="float: right;">
                                                <div class="ui button" style="padding: 0; background: none;"  @click="up(0, item)">
                                                <i class="angle up icon" style="margin: 0; font-size: 20px;"></i>
                                                </div>
                                                <div class="ui button" style="padding: 0; background: none;" @click="down(0, item)">
                                                <i class="angle down icon" style="margin: 0; font-size: 20px;"></i>
                                                </div>
                                                <div class="ui button" style="padding: 0; background: none;">
                                                <i class="delete icon" style="margin: 0; font-size: 20px;"></i>
                                                </div>
                                        </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div class="ui input processInput">
                                        <input type="text" placeholder="Treść"/>
                                    </div>
                                </td>
                                <td>
                                    <div class="ui input processInput">
                                        <input type="text" class="time" placeholder="Czas"/>
                                    </div>
                                </td>
                                <td>
                                    <div class="ui input processInput">
                                        <input type="text" placeholder="Materiały"/>
                                    </div>
                                </td>
                                <td>
                                    <div class="ui buttons">
                                        <button class="ui yellow button">
                                            <i class="ui plus icon" style="margin: 0;"></i>
                                        </button>
                                        <button class="ui negative button">
                                            <i class="ui plus icon cancelIcon" style="margin: 0;"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <table class="ui striped table">
                        <thead>
                            <tr>
                                <th colspan="2">Załączniki:</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 50%;">
                                    <ul class="ui divided list segments" style="margin: 0;">
                                        <li class="ui segment" style="padding: 10px;"><em>Materiały dodatkowe: </em></li>
                                        <li v-for="item in added.list" class="ui segment" style="padding: 10px;">
                                            <div v-if="item.edit === false">
                                                <div class="itemName">{{item.name}}</div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="deleteList(2, item)">
                                                    <i class="ui cancel outline icon editIcon"></i>
                                                </div>
                                                <div class="ui right floated button editBtn" style="padding-top: 0;" @click="editList(2, item)">
                                                    <i class="ui edit outline icon editIcon"></i>
                                                </div>
                                            </div>
                                            <div class="ui action add input" style="margin-top: 5px;" v-if="item.edit">
                                                <input type="text" v-model="item.editContent"/>
                                                <div class="ui positive button" @click="confirm(2, item)">
                                                    <i class="check icon" style="margin: 0;"></i>
                                                </div>
                                                <div class="ui negative button" @click="item.edit = false">
                                                    <i class="plus icon cancelIcon"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </td>
                                <td style="width: 50%;">
                                    <div class="ui action add input">
                                        <input type="text" v-model="added.probably" placeholder="Materiały"/>
                                        <div class="ui yellow button" @click="add(2)">
                                            <i class="plus icon" style="margin: 0;"></i>
                                        </div>
                                        <div class="ui negative button" @click="cancelList(2)">
                                            <i class="plus icon cancelIcon"></i>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</template>

<script>
export default {
    name: "FormMain",
    data(){
        return{
            today: "",
            title: {
                content: "",
                edit: true,
                probably: "",
            },
            main: {
                content: "",
                edit: true,
                probably: "",
            },
            when: {
                content: "",
                edit: true,
                probably: "",
            },
            people: {
                probably: "",
                list: [],
            },
            goals: {
                probably: "",
                list: [],
            },
            added: {
                probably: "",
                list: [],
            },
            process: {
                probably: [],
                list: [],
            },
        };
    },
    methods: {
        check(what){
            switch (what) {
                case 0:
                    if(this.title.probably){
                        this.title.edit = false;
                        this.title.content = this.title.probably;
                    }
                break;

                case 1:
                    if(this.main.probably){
                        this.main.edit = false;
                        this.main.content = this.main.probably;
                    }
                break;

                case 2:
                    if(this.when.probably){
                        this.when.edit = false;
                        this.when.content = this.when.probably;
                    }
                break;

                default:
                break;
            }
        },
        cancel(what){
            switch (what) {
                case 0:
                    if(this.title.probably){
                        if(!this.title.content){
                            this.title.probably = "";
                        }
                        else{
                            this.title.edit = false;
                        }
                    }
                break;

                case 1:
                    if(this.main.probably){
                        if(!this.main.content){
                            this.main.probably = "";
                        }
                        else{
                            this.main.edit = false;
                        }
                    }
                break;

                case 2:
                    if(this.when.probably){
                        if(!this.when.content){
                            this.when.probably = "";
                        }
                        else{
                            this.when.edit = false;
                        }
                    }
                break;

                default:
                break;
            }
        },
        edit(what){
            switch (what) {
                case 0:
                    this.title.edit = true;
                    this.title.probably = this.title.content;
                break;

                case 1:
                    this.main.edit = true;
                    this.main.probably = this.main.content;
                break;

                case 2:
                    this.when.edit = true;
                    this.when.probably = this.when.content;
                break;

                default:
                break;
            }

        },
        add(what){
            switch (what) {
                case 0:
                    if(this.people.probably){
                        this.people.list.push({
                            name: this.people.probably,
                            edit: false,
                            editContent: '',
                        });
                        this.people.probably = "";
                    }
                break;
                case 1:
                    if(this.goals.probably){
                        this.goals.list.push({
                            name: this.goals.probably,
                            edit: false,
                            editContent: '',
                        });
                        this.goals.probably = "";
                    }
                break;
                case 2:
                    if(this.added.probably){
                        this.added.list.push({
                            name: this.added.probably,
                            edit: false,
                            editContent: '',
                        });
                        this.added.probably = "";
                    }
                break;
            }
        },
        cancelList(what){
            switch(what) {
                case 0:
                    this.people.probably = "";
                break;
                case 1:
                    this.goals.probably = "";
                break;
                case 2:
                    this.added.probably = "";
                break;
            }
        },
        editList(what, item){
            var index;
            switch(what) {
                case 0:
                    index = this.people.list.indexOf(item);
                    this.people.list[index].editContent = this.people.list[index].name;
                    this.people.list[index].edit = true;
                break;

                case 1:
                    index = this.goals.list.indexOf(item);
                    this.goals.list[index].editContent = this.goals.list[index].name;
                    this.goals.list[index].edit = true;
                break;

                case 2:
                    index = this.added.list.indexOf(item);
                    this.added.list[index].editContent = this.added.list[index].name;
                    this.added.list[index].edit = true;
                break;
            }
        },
        confirm(list, item){
            var index;
            switch (list) {
                case 0:
                    index = this.people.list.indexOf(item);
                    this.people.list[index].name = this.people.list[index].editContent;
                    this.people.list[index].edit = false;
                break;

                case 1:
                    index = this.goals.list.indexOf(item);
                    this.goals.list[index].name = this.goals.list[index].editContent;
                    this.goals.list[index].edit = false;
                break;

                case 2:
                    index = this.added.list.indexOf(item);
                    this.added.list[index].name = this.added.list[index].editContent;
                    this.added.list[index].edit = false;
                break;

                default:
                break;
            }
        },
        deleteList(what, item){
            var index;
            var newLess;
            var newMore;
            switch (what) {
                case 0:
                    index = this.people.list.indexOf(item);
                    newLess = this.people.list.slice(0, index);
                    newMore = this.people.list.slice(index+1);
                    this.people.list = [].concat(newLess, newMore);
                break;

                case 1:
                    index = this.goals.list.indexOf(item);
                    newLess = this.goals.list.slice(0, index);
                    newMore = this.goals.list.slice(index+1);
                    this.goals.list = [].concat(newLess, newMore);
                break;

                case 2:
                    index = this.added.list.indexOf(item);
                    newLess = this.added.list.slice(0, index);
                    newMore = this.added.list.slice(index+1);
                    this.added.list = [].concat(newLess, newMore);
                break;

                default:
                break;
            }
        },
        up(list, item){
            var index = "";
            switch(list){
                case 0:
                    index = this.people.list.indexOf(item);
                    this.people.list.move(index, 1, index-1);
                break;
            }
        },
        down(list, item){
            var index = "";
            switch(list){
                case 0:
                    index = this.people.list.indexOf(item);
                    console.log(index-1);
                    this.people.list.move(index, 1, index-1);
                break;
            }
        },
    },
    mounted() {
        this.today = (new Date()).getDate();
    },
}
</script>

<style lang="scss" scoped>

ul.ui.list li:before{
    content: '';
    display: none;
}

#mainTable {
    width: 100%;
}

.editBtn {
    background: none;
    padding: 0;
    padding-top: 0.3em;
}

.editBtn:hover{
    background: none;
}

.editIcon{
    margin: 0;
    font-size: 20px;
}

.cancelIcon{
    margin :0 !important;
    transform: rotate(45deg);
}

.add{
    margin: auto;
}

@media only screen and (max-width: 575px){
    table:first-child{
        max-width:100%;
    }
}

.listS{
    padding: 10px;
}

.itemName {
    display: inline-block;
    max-width: 70%;
}

.processInput input {
    width: 60%;
}

.time {
    display: inline-block;
}

</style>
